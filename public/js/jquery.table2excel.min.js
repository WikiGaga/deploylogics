!function(e,t,a,n){var l="table2excel",o={exclude:".noExl",name:"Table2Excel"};function i(t,a){this.element=t,this.settings=e.extend({},o,a),this._defaults=o,this._name=l,this.init()}function s(e){return e.filename?e.filename:"table2excel"}i.prototype={init:function(){var t=this;t.template={head:'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets>',sheet:{head:"<x:ExcelWorksheet><x:Name>",tail:"</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet>"},mid:"</x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body>",table:{head:"<table>",tail:"</table>"},foot:"</body></html>"},t.tableRows=[],e(t.element).each(function(a,n){var l="";e(n).find("tr").not(t.settings.exclude).each(function(t,a){l+="<tr>"+e(a).html()+"</tr>"}),t.tableRows.push(l)}),t.tableToExcel(t.tableRows,t.settings.name)},tableToExcel:function(n,l){var o,i,r,c=this,m="";if(c.uri="data:application/vnd.ms-excel;base64,",c.base64=function(e){return t.btoa(unescape(encodeURIComponent(e)))},c.format=function(e,t){return e.replace(/{(\w+)}/g,function(e,a){return t[a]})},c.ctx={worksheet:l||"Worksheet",table:n},m=c.template.head,e.isArray(n))for(o in n)m+=c.template.sheet.head+"Table"+o+c.template.sheet.tail;if(m+=c.template.mid,e.isArray(n))for(o in n)m+=c.template.table.head+"{table"+o+"}"+c.template.table.tail;for(o in m+=c.template.foot,n)c.ctx["table"+o]=n[o];if(delete c.ctx.table,"undefined"!=typeof msie&&msie>0||navigator.userAgent.match(/Trident.*rv\:11\./)){if("undefined"!=typeof Blob){m=[m];var h=new Blob(m,{type:"text/html"});t.navigator.msSaveBlob(h,s(c.settings))}else txtArea1.document.open("text/html","replace"),txtArea1.document.write(m),txtArea1.document.close(),txtArea1.focus(),sa=txtArea1.document.execCommand("SaveAs",!0,s(c.settings))}else i=c.uri+c.base64(c.format(m,c.ctx)),(r=a.createElement("a")).download=s(c.settings),r.href=i,a.body.appendChild(r),r.click(),a.body.removeChild(r);return!0}},e.fn[l]=function(t){var a=this;return a.each(function(){e.data(a,"plugin_"+l)||e.data(a,"plugin_"+l,new i(this,t))}),a}}(jQuery,window,document);
